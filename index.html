<!DOCTYPE html>
<html>
<head>
    <title>Multiplayer VS Oyunu</title>
    <style>
        body{font-family:sans-serif;background-color:#2c3e50;color:#ecf0f1;text-align:center;margin:0;padding:20px}#login-screen{max-width:600px;margin:40px auto}.form-container{border:1px solid #34495e;border-radius:8px;padding:20px;margin:20px;background-color:#34495e}h1,h2{color:#ecf0f1}input{display:block;width:80%;padding:12px;margin:10px auto;border-radius:4px;border:1px solid #7f8c8d;background-color:#ecf0f1;font-size:1em}button{padding:12px 25px;cursor:pointer;border:none;border-radius:4px;background-color:#2980b9;color:white;font-size:1.1em;transition:background-color .3s}button:hover{background-color:#3498db}#message{font-size:1.2em;font-weight:700;height:25px;color:#e74c3c}canvas{background-color:#000;border:3px solid #ecf0f1;border-radius:8px}
    </style>
</head>
<body>
    <h1>Hesap Oluştur veya Giriş Yap</h1>
    <div id="login-screen">
        <div class="form-container">
            <h2>Kayıt Ol</h2>
            <form id="register-form">
                <input type="text" id="register-username" placeholder="Kullanıcı Adı" required>
                <input type="password" id="register-password" placeholder="Şifre" required>
                <button type="submit">Kayıt Ol</button>
            </form>
        </div>
        <div class="form-container">
            <h2>Giriş Yap</h2>
            <form id="login-form">
                <input type="text" id="login-username" placeholder="Kullanıcı Adı" required>
                <input type="password" id="login-password" placeholder="Şifre" required>
                <button type="submit">Giriş Yap</button>
            </form>
        </div>
        <p id="message"></p>
    </div>
    <canvas id="gameCanvas" width="800" height="600" style="display: none;"></canvas>
    <script>
        const loginScreen=document.getElementById("login-screen"),gameCanvas=document.getElementById("gameCanvas"),messageEl=document.getElementById("message"),registerForm=document.getElementById("register-form"),loginForm=document.getElementById("login-form");registerForm.addEventListener("submit",async e=>{e.preventDefault();const t=document.getElementById("register-username").value,s=document.getElementById("register-password").value,o=await fetch("/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t,password:s})}),n=await o.json();messageEl.innerText=n.message,n.success?messageEl.style.color="#2ecc71":messageEl.style.color="#e74c3c"}),loginForm.addEventListener("submit",async e=>{e.preventDefault();const t=document.getElementById("login-username").value,s=document.getElementById("login-password").value,o=await fetch("/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t,password:s})}),n=await o.json();messageEl.innerText=n.message,n.success?(messageEl.style.color="#2ecc71",setTimeout(()=>{loginScreen.style.display="none",gameCanvas.style.display="block",startGame()},1e3)):messageEl.style.color="#e74c3c"});function startGame(){const e=gameCanvas.getContext("2d"),t="https:"===window.location.protocol?"wss":"ws",s=new WebSocket(`${t}://${window.location.host}`);let o,n={};s.onopen=()=>console.log("Sunucuya bağlandı!"),s.onmessage=t=>{const s=JSON.parse(t.data);"init"===s.type?o=s.id:"update"===s.type&&(n=s.players,a())};function a(){e.clearRect(0,0,gameCanvas.width,gameCanvas.height);for(const t in n){const s=n[t];e.fillStyle=t==o?"#3498db":"#e74c3c",e.fillRect(s.x,s.y,s.width,s.height)}}document.addEventListener("keydown",t=>{if(!o)return;let a="";("ArrowUp"===t.key||"w"===t.key.toLowerCase())&&(a="up"),("ArrowDown"===t.key||"s"===t.key.toLowerCase())&&(a="down"),("ArrowLeft"===t.key||"a"===t.key.toLowerCase())&&(a="left"),("ArrowRight"===t.key||"d"===t.key.toLowerCase())&&(a="right"),a&&s.send(JSON.stringify({type:"move",direction:a}))})}
    </script>
</body>
</html>
